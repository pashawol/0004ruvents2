<style>
    #mpe4da3b7fbbce2345d7772b0674a318d5 {
        background-color: #316CF4;
        width: 100%;
        display: flex;
        justify-content: center;
        font-family: sans-serif;
    }

    #mpe4da3b7fbbce2345d7772b0674a318d5 .form {
        width: 400px;
        padding-left: 24px;
        padding-right: 24px;
        padding-bottom: 16px;
        padding-top: 16px;
    }

    #mpe4da3b7fbbce2345d7772b0674a318d5 * {
        box-sizing: border-box;
        font-size: 14px;
    }

    #mpe4da3b7fbbce2345d7772b0674a318d5 .form__item {
        width: 100%;
        padding: 0;
        margin-bottom: 16px;
        min-height: 42px;
    }

    #mpe4da3b7fbbce2345d7772b0674a318d5 .form__item_styled-content {
        color: #FFFFFF;
        line-height: 1.4;
    }
    }

    #mpe4da3b7fbbce2345d7772b0674a318d5 .form__item_styled-content ul,
    #mpe4da3b7fbbce2345d7772b0674a318d5 .form__item_styled-content ol {
        padding-left: 32px;
    }

    #mpe4da3b7fbbce2345d7772b0674a318d5 .form__item_styled-content ul,
    #mpe4da3b7fbbce2345d7772b0674a318d5 .form__item_styled-content ol,
    #mpe4da3b7fbbce2345d7772b0674a318d5 .form__item_styled-content li,
    #mpe4da3b7fbbce2345d7772b0674a318d5 .form__item_styled-content blockquote,
    #mpe4da3b7fbbce2345d7772b0674a318d5 .form__item_styled-content pre {
        margin: 8px 0 0 0;
    }

    #mpe4da3b7fbbce2345d7772b0674a318d5 .form__item_styled-content ul:first-child,
    #mpe4da3b7fbbce2345d7772b0674a318d5 .form__item_styled-content ol:first-child,
    #mpe4da3b7fbbce2345d7772b0674a318d5 .form__item_styled-content li:first-child,
    #mpe4da3b7fbbce2345d7772b0674a318d5 .form__item_styled-content blockquote:first-child,
    #mpe4da3b7fbbce2345d7772b0674a318d5 .form__item_styled-content pre:first-child {
        margin-top: 0;
    }

    #mpe4da3b7fbbce2345d7772b0674a318d5 .form__item_styled-content a {
        color: #F7CE46;
        text-decoration: none;
        font-weight: normal
    }

    #mpe4da3b7fbbce2345d7772b0674a318d5 .form__item_styled-content a:hover {
        text-decoration: underline;
    }

    #mpe4da3b7fbbce2345d7772b0674a318d5 .form__item_styled-content blockquote {
        color: #FFFFFF;
        line-height: 1.4;
        font-size: 12px;
        padding: 0 0 0 4px;
        border-left: 2px solid #F7CE46;
    }

    #mpe4da3b7fbbce2345d7772b0674a318d5 .form__item_styled-content code {
        background-color: #3F8EF6;
        font-family: monospace;
        font-size: 12px;
        border-radius: 4px;
    }

    #mpe4da3b7fbbce2345d7772b0674a318d5 .form__item_styled-content p {
        color: #FFFFFF;
        margin: 8px 0 0 0;
        line-height: 1.4em;
    }

    #mpe4da3b7fbbce2345d7772b0674a318d5 .form__item_styled-content p:first-child {
        margin-top: 0;
    }

    #mpe4da3b7fbbce2345d7772b0674a318d5 .form__item_styled-content p:empty {
        min-height: 1.4em;
    }

    #mpe4da3b7fbbce2345d7772b0674a318d5 .form__item_styled-content blockquote+p,
    #mpe4da3b7fbbce2345d7772b0674a318d5 .form__item_styled-content ul+p,
    #mpe4da3b7fbbce2345d7772b0674a318d5 .form__item_styled-content ol+p,
    #mpe4da3b7fbbce2345d7772b0674a318d5 .form__item_styled-content pre+p {
        margin-top: 8px;
    }

    #mpe4da3b7fbbce2345d7772b0674a318d5 .form__item_inline {
        flex-direction: row;
        justify-content: flex-start;
        align-items: center;
    }

    #mpe4da3b7fbbce2345d7772b0674a318d5 .form__item_inline .form__label {
        margin: 0 16px 0 0;
    }

    #mpe4da3b7fbbce2345d7772b0674a318d5 .form__item:last-child {
        margin-bottom: 0;
    }

    /* кнопка */
    #mpe4da3b7fbbce2345d7772b0674a318d5 .form__button {
        display: block;
        cursor: pointer;
        border: none;
        text-align: center;
        font-weight: 500;
        color: #000000;
        padding: 11px 16px;
        background: #F7CE46;
        border-radius: 4px;
        filter: drop-shadow(0px 10px 15px #F7CE4655) drop-shadow(0px 5px 5px #F7CE4633) drop-shadow(0px 2px 2px #F7CE4611);
    }

    #mpe4da3b7fbbce2345d7772b0674a318d5 .form__button.form__button_disabled {
        background: #aeaeae;
        filter: drop-shadow(0px 10px 15px rgba(110, 110, 110, 0.3)) drop-shadow(0px 5px 5px rgba(110, 110, 110, 0.2)) drop-shadow(0px 2px 2px rgba(110, 110, 110, 0.2));
    }

    #mpe4da3b7fbbce2345d7772b0674a318d5 .form__button_wrap {
        display: flex;
        justify-content: center;
    }

    /* инпут */
    #mpe4da3b7fbbce2345d7772b0674a318d5 .form__input {
        outline: none;
        width: 100%;
        color: #FFFFFF;
        padding: 8px;
        background: #3F8EF6;
        border: 1px solid #D4D4D4;
        border-radius: 4px;
        box-sizing: border-box;
    }

    /* выпадающий список и все для него */
    #mpe4da3b7fbbce2345d7772b0674a318d5 .form__dropdown {
        position: relative;
    }

    #mpe4da3b7fbbce2345d7772b0674a318d5 .form__dropdown__header {
        cursor: pointer;
        display: block;
        position: relative;
        width: 100%;
        color: #FFFFFF;
        padding: 8px;
        background: #3F8EF6;
        border: 1px solid #D4D4D4;
        border-radius: 4px;
        height: 34px;
    }

    #mpe4da3b7fbbce2345d7772b0674a318d5 .form__dropdown.multiple .form__dropdown__header {
        display: flex;
        padding: 4px 30px 4px 4px;
        flex-wrap: wrap;
        min-height: 34px;
        height: auto;
        gap: 6px;
    }

    #mpe4da3b7fbbce2345d7772b0674a318d5 .form__dropdown__value {
        cursor: default;
        display: flex;
        gap: 6px;
        padding: 0px 5px;
        border: 1px solid #D4D4D4;
        border-radius: 3px;
        background-color: #316CF4;
        align-items: center;
    }

    #mpe4da3b7fbbce2345d7772b0674a318d5 .form__dropdown__value_remove {
        cursor: pointer;
        display: flex;
        align-items: center;
    }

    #mpe4da3b7fbbce2345d7772b0674a318d5 .form__dropdown__header::after {
        display: block;
        content: '';
        border: 5px solid transparent;
        border-top: 5px solid #939393;
        position: absolute;
        top: 14px;
        right: 14px;
    }

    #mpe4da3b7fbbce2345d7772b0674a318d5 .form__dropdown__header.active::after {
        display: none;
    }

    #mpe4da3b7fbbce2345d7772b0674a318d5 .close__icon {
        display: none;
        cursor: pointer;
        position: absolute;
        top: 5px;
        right: 5px;
        width: 24px;
        height: 24px;
    }

    #mpe4da3b7fbbce2345d7772b0674a318d5 .form__dropdown__header.active+.close__icon {
        display: block;
    }

    #mpe4da3b7fbbce2345d7772b0674a318d5 .form__dropdown__checkbox_hidden:checked~.form__dropdown__header::after {
        transform: rotate(180deg) translateY(5px);
    }

    #mpe4da3b7fbbce2345d7772b0674a318d5 .form__dropdown__checkbox_hidden {
        position: absolute;
        visibility: hidden;
    }

    #mpe4da3b7fbbce2345d7772b0674a318d5 .form__dropdown__content {
        display: none;
        position: absolute;
        width: 100%;
        z-index: 2;
        border: 1px solid #D4D4D4;
        border-radius: 4px;
        background: #3F8EF6;
        max-height: 360px;
        overflow-y: auto;
    }

    #mpe4da3b7fbbce2345d7772b0674a318d5 .form__dropdown__checkbox_hidden:checked~.form__dropdown__content {
        display: block;
    }

    #mpe4da3b7fbbce2345d7772b0674a318d5 .form__dropdown__option {
        width: 100%;
        color: #FFFFFF;
        padding: 8px;
        background: #3F8EF6;
        cursor: pointer;
    }

    #mpe4da3b7fbbce2345d7772b0674a318d5 .form__dropdown__option.selected {
        display: none;
    }

    #mpe4da3b7fbbce2345d7772b0674a318d5 .form__dropdown__option:first-child {
        border-radius: 4px 4px 0 0;
    }

    #mpe4da3b7fbbce2345d7772b0674a318d5 .form__dropdown__option:last-child {
        border-radius: 0 0 4px 4px;
    }

    #mpe4da3b7fbbce2345d7772b0674a318d5 .form__dropdown__option:hover {
        background: #F7CE46;
        color: #000000;
    }

    /* Чекбокс и все для него */
    #mpe4da3b7fbbce2345d7772b0674a318d5 .form__checkbox_hidden {
        position: absolute;
        visibility: hidden;
    }

    #mpe4da3b7fbbce2345d7772b0674a318d5 .form__checkbox {
        width: 24px;
        height: 24px;
        display: block;
        position: relative;
        cursor: pointer;
    }

    #mpe4da3b7fbbce2345d7772b0674a318d5 .form__checkbox__icon {
        display: block;
    }

    #mpe4da3b7fbbce2345d7772b0674a318d5 .form__checkbox_hidden:checked~.form__checkbox .form__checkbox__icon {
        display: none;
    }

    #mpe4da3b7fbbce2345d7772b0674a318d5 .form__checkbox__icon_checked {
        display: none;
    }

    #mpe4da3b7fbbce2345d7772b0674a318d5 .form__checkbox_hidden:checked~.form__checkbox .form__checkbox__icon_checked {
        display: block;
    }

    /* лейбл */
    #mpe4da3b7fbbce2345d7772b0674a318d5 .form__label {
        margin: 0;
        margin-bottom: 4px;
        color: #FFFFFF;
    }

    #mpe4da3b7fbbce2345d7772b0674a318d5 .form__label_required::after {
        position: relative;
        content: ' *';
        color: red;
    }

    /* ошибка */
    #mpe4da3b7fbbce2345d7772b0674a318d5 .form__error {
        color: red;
        display: none;
        text-align: center;
    }

    /* успешный текст */
    #mpe4da3b7fbbce2345d7772b0674a318d5 .success {
        padding: 20px 24px;
        text-align: center;
        font-size: 32px;
        color: #FFFFFF;
        display: none;
    }

    #mpe4da3b7fbbce2345d7772b0674a318d5 .form__item.error input {
        border-color: red;
    }

    #mpe4da3b7fbbce2345d7772b0674a318d5 .form__item .form__error {
        font-size: 12px;
        display: none;
        color: red;
        text-align: left;
        margin: 2px 0 0;
    }
</style>
<section id="mpe4da3b7fbbce2345d7772b0674a318d5">
    <div class="form">
        <div class="form__item form__item_styled-content">
            <p>Заполните свои данные и мы свяжемся с вами в течение 15 минут</p>
        </div>
        <div class="form__item item__contractor_firstName">
            <p class="form__label form__label_required">Имя</p> <input type="text" class="form__input"
                placeholder="Имя">
            <p class="form__error"></p>
        </div>
        <div class="form__item item__contractor_phone">
            <p class="form__label form__label_required">Телефон</p> <input type="tel" class="form__input"
                placeholder="Телефон">
            <p class="form__error"></p>
        </div>
        <div class="form__item item__contractor_email">
            <p class="form__label form__label_required">Email</p> <input type="email" class="form__input"
                placeholder="Email">
            <p class="form__error"></p>
        </div>
        <div class="form__item form__item_styled-content">
            <p>Нажимая кнопку &quot;Отправить&quot;, я даю <a href="https://ruvents.com/consent-personal-data.pdf "
                    target="_blank">Согласие на обработку персональных данных</a></p>
        </div>
        <div class="form__item">
            <div class="form__button_wrap"> <button class="form__button">Отправить</button> </div>
        </div>
        <div class="form__item form__error"></div>
        <div class="recapthca"></div>
    </div>
    <div class="success">
        <p></p>
        <div class="form__item">
            <div class="form__button_wrap"> <button class="form__button form__restart">OK</button> </div>
        </div>
    </div>
</section>
<script> (function () {
        let isFormLocked = false;
        let reCaptcha;
        let isCaptchaReady;
        const formType = "deal";
        const contractorType = "human";
        const formId = "mpe4da3b7fbbce2345d7772b0674a318d5";
        const formRootElement = document.querySelector("#" + formId);
        const submitButton = formRootElement.querySelector(".form .form__button");
        const restartButton = formRootElement.querySelector(".form__restart");
        const phoneInputs = formRootElement.querySelectorAll(
            '.form__item [type="tel"]'
        );
        const successText = formRootElement.querySelector(".success");
        const formElement = formRootElement.querySelector(".form");
        const formError = formRootElement.querySelector(
            ".form .form__item.form__error"
        );
        const useCaptcha = false;
        const formData = {
            "contractor.firstName": {
                name: "contractor.firstName",
                value: null,
                validators: [requiredValidator],
                type: "input",
                isLogicField: false,
                logicHandler: function () { },
                settings: {},
            },
            "contractor.phone": {
                name: "contractor.phone",
                value: null,
                validators: [requiredValidator, phoneValidator],
                type: "phone",
                isLogicField: false,
                logicHandler: function () { },
                settings: {},
            },
            "contractor.email": {
                name: "contractor.email",
                value: null,
                validators: [requiredValidator, emailValidator],
                type: "email",
                isLogicField: false,
                logicHandler: function () { },
                settings: {},
            },
        };
        const elementInitializers = [];
        initForm();
        function initForm() {
            phoneInputs.forEach((element) =>
                element.addEventListener("input", phoneInputHandler, false)
            );
            restartButton.addEventListener("click", clearForm);
            submitButton.onclick = submitHandler;
            initFields();
            elementInitializers.forEach((initializer) => initializer.init());
        }
        function initFields() {
            Object.values(formData).map((item) => {
                if (item.isLogicField) {
                    item.value = item.logicHandler();
                    return;
                }
                switch (item.type) {
                    case "email":
                    case "phone":
                        const contactElement = formRootElement.querySelector(
                            ".form__item.item__" + item.name.replace(".", "_") + " .form__input"
                        );
                        contactElement.oninput = function () {
                            setField(item.name, {
                                contentType: "ContactInfo",
                                type: item.type,
                                value: contactElement.value.trim(),
                            });
                        };
                        break;
                    case "input":
                        const inputElement = formRootElement.querySelector(
                            ".form__item.item__" + item.name.replace(".", "_") + " .form__input"
                        );
                        inputElement.oninput = function () {
                            setField(item.name, inputElement.value);
                        };
                        break;
                    case "float":
                        const floatElement = formRootElement.querySelector(
                            ".form__item.item__" + item.name.replace(".", "_") + " .form__input"
                        );
                        floatElement.oninput = function () {
                            setField(item.name, parseFloat(floatElement.value));
                        };
                        break;
                    case "checkbox":
                        const checkboxElement = formRootElement.querySelector(
                            ".form__item.item__" +
                            item.name.replace(".", "_") +
                            " .form__checkbox_hidden"
                        );
                        checkboxElement.oninput = function () {
                            setField(item.name, checkboxElement.checked);
                        };
                        break;
                }
            });
        }
        function clearForm() {
            successText.style.display = "none";
            successText.querySelector("p").innerHTML = "";
            formElement.style.display = "block";
            Object.keys(formData).forEach((key) => (formData[key].value = null));
            elementInitializers.forEach((item) => item.clear());
            formRootElement
                .querySelectorAll(".form .form__input")
                .forEach((input) => (input.value = ""));
            unLockButton();
        }
        function showFormError(text) {
            formError.style.display = "block";
            formError.innerHTML = text;
            unLockButton();
        }
        function showFieldError(field, message) {
            if (!field || !formData[field]) {
                showFormError(message);
                return;
            }
            formRootElement
                .querySelector(".form .item__" + field.replace(".", "_"))
                ?.classList.add("error");
            const errField = formRootElement.querySelector(
                ".form .item__" + field.replace(".", "_") + " .form__error"
            );
            if (errField) {
                errField.innerHTML = message;
                errField.style.display = "block";
            } else {
                showFormError(message);
            }
        }
        function handleErrors(errors) {
            errors.forEach((err) => {
                showFieldError(err.field, err.message);
            });
            unLockButton();
        }
        function hideError() {
            formError.style.display = "none";
            formRootElement
                .querySelectorAll(".form .error")
                .forEach((element) => element.classList.remove("error"));
            formRootElement
                .querySelectorAll(".form .form__error")
                .forEach((errorField) => {
                    errorField.style.display = "none";
                    errorField.innerHTML = "";
                });
        }
        function showSuccess(text) {
            formElement.style.display = "none";
            successText.style.display = "block";
            successText.querySelector("p").innerHTML = text;
            unLockButton();
        }
        function setField(fieldName, value) {
            hideError();
            formData[fieldName].value = value;
        }
        function getContentTypeForContractor(contractorType) {
            return contractorType === "human" ? "ContractorHuman" : "ContractorCompany";
        }
        async function submitHandler() {
            if (isFormLocked) {
                return;
            }
            lockButton();
            const fields = Object.values(formData);
            const isValid =
                fields
                    .map(
                        (item) =>
                            item.validators
                                .map((validator) => {
                                    const validateError = validator(item.value);
                                    if (validateError) {
                                        showFieldError(item.name, validateError);
                                    }
                                    return !validateError;
                                })
                                .filter(Boolean).length === item.validators.length
                    )
                    .filter(Boolean).length === fields.length;
            const contactInfo = [];
            if (isValid) {
                const request = fields.reduce((dataObj, item) => {
                    if (["email", "phone"].includes(item.type)) {
                        if (item.value?.value?.trim()) {
                            contactInfo.push(item.value);
                        }
                        return dataObj;
                    }
                    if (item.name.startsWith("contractor.")) {
                        if (!dataObj.contractor) {
                            dataObj.contractor = {
                                contentType: getContentTypeForContractor(contractorType),
                            };
                        }
                        dataObj.contractor[item.name.replace("contractor.", "")] = item.value;
                    } else {
                        dataObj[item.name] = item.value;
                    }
                    return dataObj;
                }, {});
                if (formType === "deal") {
                    request.contentType = "Deal";
                    if (!!request.contractor) {
                        request.contractor.contactInfo = contactInfo;
                    }
                } else {
                    request.contentType = getContentTypeForContractor(contractorType);
                    request.contactInfo = contactInfo;
                }
                sendRequest(request);
            } else {
                unLockButton();
            }
        }
        function lockButton() {
            isFormLocked = true;
            submitButton.classList.add("form__button_disabled");
            submitButton.onclick = null;
        }
        function unLockButton() {
            isFormLocked = false;
            submitButton.classList.remove("form__button_disabled");
            submitButton.onclick = submitHandler;
        }
        function phoneInputHandler(e) {
            e.target.value = e.target.value.replace(/[^\d()\-+]/g, "");
        }
        function requiredValidator(value) {
            return !value ? "Поле обязательно для заполнения" : "";
        }
        function emailValidator(contactInfo) {
            return contactInfo &&
                contactInfo.value &&
                !contactInfo.value.match(/.+@.+\..+/i)
                ? "Некорректный email"
                : "";
        }
        function phoneValidator(contactInfo) {
            return contactInfo &&
                contactInfo.value &&
                !contactInfo.value.match(/^\+?[\d()\-\s]+$/)
                ? "Некорректный номер телефона"
                : "";
        }
        function sendRequest(request) {
            const reqParams = useCaptcha
                ? "?" + JSON.stringify({ token: reCaptcha.getToken() })
                : "";
            fetch(
                "https://ruvents.megaplan.ru/api/v3/customLeadForm/5/process/deal" +
                reqParams,
                {
                    method: "POST",
                    headers: {
                        Accept: "application/json, text/plain, */*",
                        "Content-Type": "application/json",
                    },
                    body: JSON.stringify(request),
                }
            )
                .then((response) => response.json())
                .then((data) => {
                    if (data?.meta?.status !== 200) {
                        if (!data?.meta?.errors || data?.meta?.status > 500) {
                            throw new Error();
                        }
                        handleErrors(data.meta.errors);
                        return;
                    }
                    showSuccess("Благодарим за обращение. Мы скоро с Вами свяжемся");
                })
                .catch(() => {
                    showFormError("При отправке формы произошла ошибка. Попробуйте позже.");
                });
        }
    })();
</script>